---
title: "COVID in Mexico"
description: |
  A Date Visualisation of COVID in Mexico.
author:
  - name: Xinran Liu
    url: https://example.com/norajones
date: 08-31-2021
preview: Mexico.jpeg
output:
  distill::distill_article:
    self_contained: false
---


```{r,include=FALSE}
knitr::opts_chunk$set(echo = FALSE,message = FALSE,warning = FALSE)
```

```{r ,include=FALSE}
library(tidyverse)
library(here)
library(ggplot2)
library(kableExtra)
library(plotly)
library(gganimate)
library(lubridate)
```

```{css ,echo = FALSE, eval=F}
.title, .subtitle {
  text-transform: uppercase;
  font-family: copperplate;
}
.author {
  font-family: serif;
}
.date {
  font-family: papyrus;
}
body {
  background-color: white;
  color: black;
  font-size: 20px;
}
strong {
  color: brown;
}

```
# Data Description

The data in this Blog is from [ourworldindata.org](hhttps://ourworldindata.org/coronavirus/country/mexico).

The data is available in **csv**, **xlsx**format. I'm useing **csv** format for this blog post.

```{r read,include=FALSE}
covid <- read_csv(here::here("data/owid-covid-data.csv"))

covid_mex <- covid %>% 
  filter(location == "Mexico") %>% 
  mutate(date=as.Date(date))
```

The main dataset is of dimensions **`r dim(covid)`**, whereas that of **Mexico** alone is **`r dim(covid_mex)`**.

# Analysis & Findings

## The Trend of Case Number

```{r total, fig.cap="The Trend of Total COVID Case Number",message=FALSE, warning=FALSE}
totalplot <-covid_mex %>% 
  rename("Date" = date,
         "Total Cases" = total_cases,
         "New Cases" = new_cases,
         "New Tests" = new_tests) %>% 
  ggplot(aes(x=Date, y=`Total Cases`))+
  geom_point(aes(size=`Total Cases`, color= `New Cases`), alpha=1/10)+
  theme_light()
totalplot <- ggplotly(totalplot)
totalplot
```

```{r totaldeath, fig.cap="The Growth of Carform Cases and Death Number"}
covid_mex%>% 
  select(total_deaths,total_cases,date) %>% 
  mutate(`Death Rate` = total_deaths/total_cases) %>% 
  pivot_longer(cols = c(total_deaths,total_cases), 
               names_to = "Variable",   
               values_to = "Count Number") %>% 
  ggplot( aes(x = Variable, y =`Count Number`, fill=Variable)) +
  geom_bar(stat='identity', position='identity') +
  scale_fill_manual(values = c("#4fa9c9", "#2a7189"))+
  theme_bw() +
  labs(title = 'Date: {round(frame_time)}', 
       x = ' ', 
       y = 'Number of People') +
  transition_time(date)
```

```{r}
deathrate <- covid_mex%>% 
  select(total_deaths,total_cases,date) %>% 
  mutate(death_rate = total_deaths/total_cases) %>%
  mutate(death_rate = as.numeric(death_rate)) %>% 
  select(death_rate) %>% 
  drop_na() 
```
The average COVID death rate of Mexico is `r mean(deathrate$death_rate)`

## The Trend of Daily Case Number
```{r daily, fig.cap="The Trend of Daily Case Number"}
dailyplot <- covid_mex %>% 
  rename("Date" = date,
         "Total Cases" = total_cases,
         "New Cases" = new_cases,
         "New Tests" = new_tests) %>% 
  ggplot(aes(x=Date, y=`New Cases`))+
  geom_line(color="steelblue")+
  theme_light()
dailyplot <- ggplotly(dailyplot)
dailyplot
```

## Top 6 Days With Biggest COVID Cases Number

```{r case,echo=FALSE}
case <- covid_mex %>% 
  select(date, total_cases, new_cases, new_tests, total_tests) %>% 
  mutate(`Percentage of New Cases` = round((new_cases/new_tests)*100,2)) %>% 
  slice_max(new_cases, n=6) 
case%>% 
  rename("Date" = date,
         "Total Cases" = total_cases,
         "New Cases" = new_cases,
         "New Tests" = new_tests,
         "Total Tests" = total_tests) %>% 
  kable(caption = "Top 6 Days With Biggest Number of COVID Cases") %>% 
  kable_styling(bootstrap_options = c("striped", "hover"))
```

```{r newcase,echo=FALSE}
newcase <- covid_mex %>% 
  select(date, total_cases, new_cases, new_tests, total_tests) %>% 
  mutate(`Percentage of New Cases` = round((new_cases/new_tests)*100,2)) %>%  
  slice_max(`Percentage of New Cases`,n = 6) 
newcase%>% 
  rename("Date" = date,
         "Total Cases" = total_cases,
         "New Cases" = new_cases,
         "New Tests" = new_tests,
         "Total Tests" = total_tests) %>%  
  kable(caption = "Top 6 Days With Biggest Percetage of New COVID Cases") %>% 
  kable_styling(bootstrap_options = c("striped", "hover"))

```

The table \@ref(tab:case) and \@ref(tab:newcase) above shows that:

`r case[1,1]` reported maximum new COVID cases.<br>
`r newcase[1,1]` had a more percentage of new cases reported.

## The Percentage Trend of Test for COVID

```{r test, fig.cap="The Percentage Trend of People Get Test for COVID"}
testsplot <- covid_mex %>% 
  mutate(`Tests Percentage`=total_tests_per_thousand/1000) %>% 
  rename("Date"=date) %>% 
  ggplot(aes(x = Date,
             y =`Tests Percentage`))+
  geom_line(color="#4E84C4")+
  theme_light()
testsplot <- ggplotly(testsplot)
testsplot
```

```{r postitive, fig.cap="The Rate Trend of People Get Test Positive for COVID"}
postitiveplot <- covid_mex %>% 
  rename("Date" = date,
         "Positive Rate" = positive_rate) %>% 
  ggplot(aes(x = Date,
             y =`Positive Rate`))+
  geom_line(color="#4E84C4")+
  theme_light()
postitiveplot <- ggplotly(postitiveplot)
postitiveplot
```

## The Percentage Trend of People Get Vaccin
```{r vaccin, fig.cap="The Percentage Trend of People Get Vaccin"}
vaccinplot <- covid_mex %>% 
  mutate(`Vaccin Rate` = people_vaccinated/population)%>% 
  rename("Date"=date) %>% 
  ggplot(aes(Date, `Vaccin Rate`))+
  geom_line(color =  "#293352")+
  theme_light()
vaccinplot <- ggplotly(vaccinplot)
vaccinplot
```